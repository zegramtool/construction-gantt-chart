# 工事工程表バーチャートアプリ 仕様書

## 概要
工事工程表をExcel形式のバーチャートで作成・管理し、PDF/PNG/Excel形式でエクスポートできるWebアプリケーション

## 機能要件

### 1. スケール機能
- **時間スケール**: 5分刻みで時間単位の工程表を作成
  - デフォルト表示範囲: 8時〜18時（設定可能）
  - 時間と分を別々に入力可能（モバイル対応）
  - デフォルトタスク時間: 8:00〜9:00
- **日スケール**: 日単位の工程表（デフォルト: 7日間、設定可能）
- **週スケール**: 週単位の工程表（デフォルト: 30日間、設定可能）
- **月スケール**: 月単位の工程表（デフォルト: 60日間、設定可能）

### 2. プロジェクト管理
- プロジェクトの作成・編集・削除
- プロジェクト情報: 工事名称、現場住所、現場管理者、全体工期、備考
- 日程未定モード: 相対的な日数・時間で表示（年月を表示しない）

### 3. タスク管理
- タスクの追加・編集・削除
- タスク情報: 工程名、担当者、開始時間/日、終了時間/日
- ドラッグ&ドロップでタスクの順序変更
- スケール別に独立した日程値を保持
- タスクごとの色設定（12色のパレットから選択）
- 業種（Trade）の設定と色分け

### 4. 業種管理
- 業種の追加・編集・削除
- 業種ごとの色設定
- デフォルト業種: 電気工事、配管工事、大工工事、塗装工事、内装工事、外構工事、その他

### 5. 稼働日設定
- 土曜日のスキップ設定
- 日曜日のスキップ設定
- 祝日のスキップ設定
- カスタム休日・稼働日の設定

### 6. エクスポート機能
- **PDFエクスポート**: jsPDF + html2canvasを使用
- **PNGエクスポート**: html2canvasを使用
- **Excelエクスポート**: ExcelJSを使用
- エクスポート設定: 用紙サイズ（A4/A3/B4）、向き（縦/横）、スケール

### 7. プレビュー機能
- リアルタイムプレビュー（PrintPreview）
- A4横比率で1画面に収まる表示
- エクスポート前のプレビュー表示

### 8. レスポンシブ対応
- PC版: フル機能のバーチャート表示
- モバイル版: タッチ操作対応、時間入力の最適化

## 技術スタック

### フロントエンド
- React 18 + TypeScript
- Vite（ビルドツール）
- Tailwind CSS v4（CSS-in-file @theme方式）
- Zustand（状態管理、localStorage永続化）
- date-fns（日付操作）
- @holiday-jp/holiday_jp（日本の祝日判定）

### UIコンポーネント
- Radix UI（Select、Dialog等）
- Lucide React（アイコン）
- カスタムコンポーネント（Button、Input、Card等）

### エクスポート
- jsPDF（PDF生成）
- html2canvas（HTML→画像変換）
- ExcelJS（Excel生成）

## データ構造

### Project（プロジェクト）
```typescript
interface Project {
  id: string;
  name: string;              // 工事名称
  address: string;           // 現場住所
  manager: string;           // 現場管理者
  startDate: string;         // 開始日
  endDate: string;          // 終了日
  remarks: string;           // 備考
  isProvisional: boolean;    // 日程未定フラグ
  viewScale: ViewScale;     // 表示スケール
  hourScaleSettings?: {      // 時間スケール設定
    startHour: number;       // 開始時間（0-23）
    endHour: number;        // 終了時間（1-24）
  };
  dayScaleSettings?: {      // 日数スケール設定
    dayCount: number;        // 日スケールの表示日数
    weekCount: number;      // 週スケールの表示日数
    monthCount: number;      // 月スケールの表示日数
  };
  workdaySettings: WorkdaySettings;
  createdAt: string;
  updatedAt: string;
}
```

### Task（タスク）
```typescript
interface Task {
  id: string;
  projectId: string;
  tradeId?: string;          // 業種ID
  name: string;              // 工程名
  assignee: string;          // 担当者
  startDate: string;        // 開始日（互換性のため保持）
  endDate: string;          // 終了日（互換性のため保持）
  color?: string;           // タスクの色
  order: number;            // 表示順序
  scaleSchedule?: {          // スケール別の独立した値
    hour: { start: number; end: number };   // 分単位（5分刻み）
    day: { start: number; end: number };    // 日目
    week: { start: number; end: number };   // 日目
    month: { start: number; end: number };  // 日目
  };
}
```

## UI/UX要件

### 時間スケール
- 5分刻みの時間スロット表示
- 時間マーク（時単位）のみヘッダーに表示
- 時間と分を別々に入力（モバイル対応）
- デフォルト: 8時〜18時

### 日・週・月スケール
- 日単位で表示（週・月スケールも日単位のセル）
- ヘッダー: 日数 + 曜日（例: "1（月）"、"2（火）"）
- 土日の色分け表示（土=青、日=赤）

### モバイル対応
- タッチ操作対応
- 時間入力の最適化（数値入力キーボード）
- レスポンシブレイアウト

## 今後の実装予定
- Firebase Authentication（認証機能）
- Firebase Firestore（クラウドデータ保存）
- ユーザー管理機能
- プロジェクトの共有機能

## 更新履歴
- 2026-01-27: 初版作成
  - 時間スケール（5分刻み）実装
  - スケール別の独立した値管理
  - モバイル対応の時間入力UI
  - タスクの色設定機能
  - ドラッグ&ドロップによる順序変更
  - タスク名のクリック編集
  - スケール別の表示日数設定
